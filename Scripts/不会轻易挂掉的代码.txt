-- 作者：Minja-- 创建空列表set urlList to {}set nameList to {}set mdlinkList to {}set the date_stamp to ((the current date) as string)set NoteTitle to "# Safari 文章阅读清单 " & the date_stamp-- 从 Safari 获取标签页标题和链接，填入对应列表tell application "Safari"	set topWindow to window 1	set topTabs to every tab of topWindow	repeat with t in topTabs		set the end of urlList to (URL of t)		set the end of nameList to (name of t)	end repeatend tell-- 选择要导出的页面，跳过则默认全选choose from list nameList with title "请选择要导出的页面" with multiple selections allowedif result is not false then	set nameChoice to resultelse	set nameChoice to nameListend if-- 根据选出来的页面，创建对应的 Markdown 格式链接repeat with i from 1 to the count of nameChoice	repeat with t from 1 to the count of nameList		if item t of nameList is item i of nameChoice then set the end of mdlinkList to ((i as string) & ". [" & (item t of nameList) & "](" & (item t of urlList) & ")\n")	end repeatend repeat-- 暂时把 AppleScript 默认分隔符换成回车，便于排版，排好文本内容后恢复系统分隔符set old_delim to AppleScript's text item delimitersset AppleScript's text item delimiters to returnset mdlinkList to (NoteTitle & "\n\n" & mdlinkList) as textset AppleScript's text item delimiters to old_delim-- 准备好文本文件tell application "Finder"	activate	set saveMarkdown to choose file name with prompt "创建阅读清单：" default name "Safari 文章阅读清单.md" default location (path to desktop folder)end tellset saveMarkdown to the POSIX path of saveMarkdown-- 调用 shell 脚本绕开 AppleScript 中文编码显示问号的问题do shell script "echo " & quoted form of mdlinkList & " > " & quoted form of saveMarkdown-- 生成 HTML 文件do shell script "PATH=$PATH:/usr/local/bin/;pandoc -f markdown -t html -o ~/Desktop/Safari\\ 文章阅读清单.html ~/Desktop/Safari\\ 文章阅读清单.md"